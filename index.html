<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <!-- 移动端视口设置：锁定缩放，确保布局基准一致 -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>茶百戏绘画交互</title>
    <style>
        /* 重置默认样式 */
        body { margin: 0; padding: 0; font-family: "Microsoft YaHei"; }
        /* 父容器：垂直Flex布局，占满屏幕高度 */
        .container { display: flex; flex-direction: column; height: 100vh; background-color: #F7F3EB; }
        /* 茶汤展示区：居中放置圆形Canvas（模拟茶盏） */
        .show-area { flex: 7; display: flex; justify-content: center; align-items: center; }
        #teaCanvas { 
            width: 80%; height: 80%; max-width: 300px; max-height: 300px;
            border: 4px solid #8B5A2B; border-radius: 50%; /* 圆形茶盏样式 */
            background-color: #3A2618; box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        /* 创作控制区：横向Flex，分图案选择与功能按钮 */
        .control-area { flex: 3; display: flex; padding: 15px; gap: 10px; }
        .pattern-select { flex: 6; display: flex; justify-content: space-around; align-items: center; }
        .func-buttons { flex: 4; display: flex; flex-direction: column; justify-content: space-around; align-items: center; }
        /* 按钮样式：适配移动端触摸（最小尺寸44px×44px） */
        button { 
            width: 80px; height: 44px; border: none; border-radius: 8px;
            background-color: #8B5A2B; color: white; font-size: 14px; cursor: pointer;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- 茶汤展示区：Canvas用于绘制 -->
        <div class="show-area">
            <canvas id="teaCanvas"></canvas>
        </div>
        <!-- 创作控制区：图案选择+功能按钮 -->
        <div class="control-area">
            <div class="pattern-select">
                <button onclick="selectPattern('bamboo')">竹</button>
                <button onclick="selectPattern('landscape')">山水</button>
                <button onclick="selectPattern('flower')">花鸟</button>
            </div>
            <div class="func-buttons">
                <button onclick="clearCanvas()">清空</button>
                <button onclick="fadePattern()">点汤幻茶</button>
            </div>
        </div>
    </div>

    <script>
        // Canvas初始化：解决不同设备模糊问题（适配设备像素比DPR）
        const canvas = document.getElementById('teaCanvas');
        const ctx = canvas.getContext('2d');
        const dpr = window.devicePixelRatio || 1;
        const canvasWidth = canvas.offsetWidth;
        const canvasHeight = canvas.offsetHeight;
        // 设置Canvas实际像素尺寸（避免模糊）
        canvas.width = canvasWidth * dpr;
        canvas.height = canvasHeight * dpr;
        ctx.scale(dpr, dpr); // 缩放上下文

        // 绘画交互：触摸事件监听
        let isDrawing = false;
        let lastX = 0, lastY = 0;

        // 触摸开始：记录初始位置
        canvas.addEventListener('touchstart', (e) => {
            e.preventDefault(); // 阻止页面滚动干扰
            const touch = e.touches[0];
            const rect = canvas.getBoundingClientRect();
            lastX = touch.clientX - rect.left;
            lastY = touch.clientY - rect.top;
            isDrawing = true;
        });

        // 触摸移动：绘制乳白色线条（模拟茶沫）
        canvas.addEventListener('touchmove', (e) => {
            if (!isDrawing) return;
            e.preventDefault();
            const touch = e.touches[0];
            const rect = canvas.getBoundingClientRect();
            const x = touch.clientX - rect.left;
            const y = touch.clientY - rect.top;

            ctx.beginPath();
            ctx.moveTo(lastX, lastY);
            ctx.lineTo(x, y);
            ctx.strokeStyle = '#F5F5F5'; ctx.lineWidth = 3; ctx.lineCap = 'round';
            ctx.stroke();
            lastX = x; lastY = y;
        });

        // 触摸结束：停止绘制
        canvas.addEventListener('touchend', () => isDrawing = false);

        // 辅助功能：选择图案（绘制淡灰色轮廓）、清空画布、图案消散
        function selectPattern(type) {
            const patterns = {
                bamboo: [{x: 50, y: 200}, {x: 60, y: 100}, {x: 70, y: 50}], // 竹轮廓坐标
                landscape: [{x: 30, y: 220}, {x: 80, y: 150}, {x: 130, y: 220}], // 山水轮廓坐标
                flower: [{x: 100, y: 180}, {x: 120, y: 150}, {x: 100, y: 120}, {x: 80, y: 150}] // 花鸟轮廓坐标
            };
            const points = patterns[type];
            ctx.beginPath();
            points.forEach((p, i) => i === 0 ? ctx.moveTo(p.x, p.y) : ctx.lineTo(p.x, p.y));
            ctx.strokeStyle = 'rgba(245,245,245,0.3)'; ctx.lineWidth = 2; ctx.stroke();
        }
        function clearCanvas() { ctx.clearRect(0, 0, canvasWidth, canvasHeight); }
        function fadePattern() {
            // 径向渐变：模拟茶汤图案消散
            const gradient = ctx.createRadialGradient(
                canvasWidth/2, canvasHeight/2, 0,
                canvasWidth/2, canvasHeight/2, canvasWidth/2
            );
            gradient.addColorStop(0, 'rgba(58,38,24,0.8)');
            gradient.addColorStop(1, 'rgba(58,38,24,1)');
            ctx.fillStyle = gradient; ctx.fillRect(0, 0, canvasWidth, canvasHeight);
        }
    </script>
</body>
</html>
