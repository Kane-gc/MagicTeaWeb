<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>茶百戏作品画廊</title>
    <style>
        body { margin: 0; padding: 0; font-family: "Microsoft YaHei"; }
        /* 父容器：垂直Flex，占满屏幕 */
        .gallery-container { display: flex; flex-direction: column; height: 100vh; background-color: #F7F3EB; }
        /* 标题栏：居中显示标题 */
        .title-bar { height: 50px; display: flex; justify-content: center; align-items: center; border-bottom: 1px solid #E0D8C8; }
        .title-bar h3 { margin: 0; color: #8B5A2B; }
        /* 作品墙：Grid布局，自动适配列数（最小列宽120px） */
        .works-wall { flex: 1; display: grid; grid-template-columns: repeat(auto-fill, minmax(120px, 1fr)); grid-gap: 15px; padding: 15px; overflow-y: auto; }
        /* 作品卡片：固定尺寸，含缩略图与名称 */
        .work-card { width: 120px; height: 150px; display: flex; flex-direction: column; align-items: center; cursor: pointer; }
        .work-card img { width: 120px; height: 120px; border-radius: 8px; object-fit: cover; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
        .work-card p { margin: 5px 0 0; font-size: 12px; color: #3A2618; }
        /* 底部返回栏：居中显示返回按钮 */
        .back-bar { height: 50px; display: flex; justify-content: center; align-items: center; border-top: 1px solid #E0D8C8; }
        #backBtn { width: 120px; height: 40px; border: none; border-radius: 8px; background-color: #8B5A2B; color: white; font-size: 14px; }
        /* 预览模态框：固定定位，居中显示作品大图与操作按钮 */
        .preview-modal { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.7); display: none; justify-content: center; align-items: center; z-index: 100; }
        .preview-content { width: 90%; height: 60%; background-color: white; border-radius: 12px; padding: 20px; display: flex; flex-direction: column; align-items: center; }
        .preview-img { width: 100%; height: 70%; border-radius: 8px; object-fit: contain; }
        .preview-name { margin: 10px 0; color: #8B5A2B; }
        .preview-buttons { display: flex; gap: 20px; margin-top: 10px; }
        .preview-buttons button { width: 100px; height: 40px; border: none; border-radius: 8px; background-color: #8B5A2B; color: white; font-size: 14px; }
        #closeBtn { background-color: #E0D8C8; color: #3A2618; }
    </style>
</head>
<body>
    <div class="gallery-container">
        <!-- 标题栏 -->
        <div class="title-bar">
            <h3>茶百戏作品画廊</h3>
        </div>
        <!-- 作品墙：动态渲染作品卡片 -->
        <div class="works-wall" id="worksWall"></div>
        <!-- 底部返回栏 -->
        <div class="back-bar">
            <button id="backBtn" onclick="window.location.href='绘画交互.html'">返回绘画</button>
        </div>
    </div>

    <!-- 作品预览模态框（默认隐藏） -->
    <div class="preview-modal" id="previewModal">
        <div class="preview-content">
            <img src="" alt="作品预览" class="preview-img" id="previewImg">
            <h4 class="preview-name" id="previewName"></h4>
            <div class="preview-buttons">
                <button id="arBtn">AR观赏</button>
                <button id="shareBtn">分享作品</button>
                <button id="closeBtn" onclick="closePreview()">关闭</button>
            </div>
        </div>
    </div>

    <script>
        // 模拟用户作品数据（实际可从localStorage或后端获取）
        const userWorks = [
            { id: 1, url: "work1.jpg", name: "竹之韵" },
            { id: 2, url: "work2.jpg", name: "山水间" },
            { id: 3, url: "work3.jpg", name: "花鸟图" },
            { id: 4, url: "work4.jpg", name: "寒江雪" },
            { id: 5, url: "work5.jpg", name: "东篱菊" }
        ];

        // 渲染作品墙：根据屏幕宽度自动排列列数
        const worksWall = document.getElementById('worksWall');
        function renderWorks() {
            worksWall.innerHTML = ""; // 清空现有内容
            userWorks.forEach(work => {
                const card = document.createElement('div');
                card.className = "work-card";
                // 拼接卡片内容（缩略图+名称）
                card.innerHTML = `
                    <img src="${work.url}" alt="${work.name}">
                    <p>${work.name}</p>
                `;
                // 点击卡片打开预览模态框
                card.onclick = () => openPreview(work);
                worksWall.appendChild(card);
            });
        }
        renderWorks(); // 初始化渲染

        // 预览模态框功能：显示作品大图、AR观赏、分享
        const previewModal = document.getElementById('previewModal');
        const previewImg = document.getElementById('previewImg');
        const previewName = document.getElementById('previewName');
        const arBtn = document.getElementById('arBtn');
        const shareBtn = document.getElementById('shareBtn');

        function openPreview(work) {
            previewImg.src = work.url;
            previewName.textContent = work.name;
            previewModal.style.display = "flex"; // 显示模态框

            // AR观赏：模拟跳转AR页面（传递作品ID）
            arBtn.onclick = () => window.location.href = `ar-view.html?workId=${work.id}`;

            // 分享作品：模拟生成含宋代印章的分享图（简化版）
            shareBtn.onclick = () => {
                alert(`《${work.name}》分享图已生成，可保存至相册并分享到社交平台`);
            };
        }

        // 关闭预览模态框
        function closePreview() {
            previewModal.style.display = "none";
        }

        // 点击模态框背景关闭（可选优化）
        previewModal.onclick = (e) => {
            if (e.target === previewModal) closePreview();
        };
    </script>
</body>
</html>
